<div class="container">
  <h1 class="text-center text-white mt-4">Your Chats</h1>
  <% if @chats.any? %>
    <ul class="list-unstyled">
      <% @chats.each do |chat| %>
        <li class="mb-3 d-flex align-items-center">
          <%= link_to chat_path(chat), class: "btn btn-light flex-grow-1 text-start d-flex align-items-center me-2" do %>
            <% other_user = chat.their_user(current_user) %>
            <%= image_tag other_user.image.attached? ? other_user.image : 'default_avatar.png', class: "rounded-circle me-2", style: "width: 40px; height: 40px; object-fit: cover;" %>
            <div class="flex-grow-1">
              <strong><%= other_user.name || other_user.email %></strong>
              <small class="text-muted d-block">
                <%= chat.messages.last ? time_ago_in_words(chat.messages.last.created_at) + " ago" : "No messages yet" %>
              </small>
            </div>
          <% end %>
          <%= button_to "Delete", chat_path(chat), method: :delete, data: { turbo_confirm: "Are you sure you want to delete this chat?", turbo_frame: "_top" }, class: "btn btn-outline-danger btn-sm text-danger bg-white" %>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p>You don't have any chats yet.</p>
  <% end %>

</div>
